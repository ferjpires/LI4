-- Procedure para inserir um Utilizador
CREATE PROCEDURE spUtilizador_Insert
    @Nome NVARCHAR(45),
    @Senha NVARCHAR(45),
    @NIF CHAR(9),
    @DataDeNascimento DATETIME,
    @DataDeCriacao DATETIME,
    @ImagemURL NVARCHAR(90),
    @QuantidadeDeProdutosRealizados INT,
    @QuantidadeDeProdutosRejeitados INT,
    @MediaDeSatisfacao DECIMAL(4, 2),
    @TempoMedioPorProduto TIME,
    @Tipo NVARCHAR(20)
AS
BEGIN
    INSERT INTO Utilizador (
        Nome, Senha, NIF, DataDeNascimento, DataDeCriacao,
        ImagemURL, QuantidadeDeProdutosRealizados, QuantidadeDeProdutosRejeitados,
        MediaDeSatisfacao, TempoMedioPorProduto, Tipo
    )
    VALUES (
        @Nome, @Senha, @NIF, @DataDeNascimento, @DataDeCriacao,
        @ImagemURL, @QuantidadeDeProdutosRealizados, @QuantidadeDeProdutosRejeitados,
        @MediaDeSatisfacao, @TempoMedioPorProduto, @Tipo
    );
END;
GO

-- Procedure para atualizar um Utilizador
CREATE PROCEDURE spUtilizador_Update
    @ID INT,
    @Nome NVARCHAR(45),
    @Senha NVARCHAR(45),
    @NIF CHAR(9),
    @DataDeNascimento DATETIME,
    @ImagemURL NVARCHAR(90),
    @QuantidadeDeProdutosRealizados INT,
    @QuantidadeDeProdutosRejeitados INT,
    @MediaDeSatisfacao DECIMAL(4, 2),
    @TempoMedioPorProduto TIME,
    @Tipo NVARCHAR(20)
AS
BEGIN
    UPDATE Utilizador
    SET
        Nome = @Nome,
        Senha = @Senha,
        NIF = @NIF,
        DataDeNascimento = @DataDeNascimento,
        ImagemURL = @ImagemURL,
        QuantidadeDeProdutosRealizados = @QuantidadeDeProdutosRealizados,
        QuantidadeDeProdutosRejeitados = @QuantidadeDeProdutosRejeitados,
        MediaDeSatisfacao = @MediaDeSatisfacao,
        TempoMedioPorProduto = @TempoMedioPorProduto,
        Tipo = @Tipo
    WHERE ID = @ID;
END;
GO

-- Procedure para inserir um Produto
CREATE PROCEDURE spProduto_Insert
    @Nome NVARCHAR(45),
    @Categoria NVARCHAR(15),
    @Preco DECIMAL(4, 2),
    @QuantidadeDeRealizacoes INT,
    @QuantidadeDeVendas INT,
    @QuantidadeDeRejeicoes INT,
    @MediaDeSatisfacao DECIMAL(4, 2),
    @MediaDoTempoDeMontagem TIME,
    @QuantidadeEmStock INT,
    @ImagemURL NVARCHAR(90),
    @IDAdministrador INT
AS
BEGIN
    INSERT INTO Produto (
        Nome, Categoria, Preco, QuantidadeDeRealizacoes, QuantidadeDeVendas,
        QuantidadeDeRejeicoes, MediaDeSatisfacao, MediaDoTempoDeMontagem,
        QuantidadeEmStock, ImagemURL, IDAdministrador
    )
    VALUES (
        @Nome, @Categoria, @Preco, @QuantidadeDeRealizacoes, @QuantidadeDeVendas,
        @QuantidadeDeRejeicoes, @MediaDeSatisfacao, @MediaDoTempoDeMontagem,
        @QuantidadeEmStock, @ImagemURL, @IDAdministrador
    );
END;
GO

-- Procedure para atualizar um Produto
CREATE PROCEDURE spProduto_Update
    @ID INT,
    @Nome NVARCHAR(45),
    @Categoria NVARCHAR(15),
    @Preco DECIMAL(4, 2),
    @QuantidadeDeRealizacoes INT,
    @QuantidadeDeVendas INT,
    @QuantidadeDeRejeicoes INT,
    @MediaDeSatisfacao DECIMAL(4, 2),
    @MediaDoTempoDeMontagem TIME,
    @QuantidadeEmStock INT,
    @ImagemURL NVARCHAR(90),
    @IDAdministrador INT
AS
BEGIN
    UPDATE Produto
    SET
        Nome = @Nome,
        Categoria = @Categoria,
        Preco = @Preco,
        QuantidadeDeRealizacoes = @QuantidadeDeRealizacoes,
        QuantidadeDeVendas = @QuantidadeDeVendas,
        QuantidadeDeRejeicoes = @QuantidadeDeRejeicoes,
        MediaDeSatisfacao = @MediaDeSatisfacao,
        MediaDoTempoDeMontagem = @MediaDoTempoDeMontagem,
        QuantidadeEmStock = @QuantidadeEmStock,
        ImagemURL = @ImagemURL,
        IDAdministrador = @IDAdministrador
    WHERE ID = @ID;
END;
GO

-- Procedure para inserir um Ingrediente
CREATE PROCEDURE spIngrediente_Insert
    @Nome NVARCHAR(45),
    @Preco DECIMAL(4, 2),
    @QuantidadeEmStock INT,
    @EmUso BIT,
    @ImagemURL NVARCHAR(90),
    @IDAdministrador INT
AS
BEGIN
    INSERT INTO Ingrediente (
        Nome, Preco, QuantidadeEmStock, EmUso, ImagemURL, IDAdministrador
    )
    VALUES (
        @Nome, @Preco, @QuantidadeEmStock, @EmUso, @ImagemURL, @IDAdministrador
    );
END;
GO

-- Procedure para atualizar um Ingrediente
CREATE PROCEDURE spIngrediente_Update
    @ID INT,
    @Nome NVARCHAR(45),
    @Preco DECIMAL(4, 2),
    @QuantidadeEmStock INT,
    @EmUso BIT,
    @ImagemURL NVARCHAR(90),
    @IDAdministrador INT
AS
BEGIN
    UPDATE Ingrediente
    SET
        Nome = @Nome,
        Preco = @Preco,
        QuantidadeEmStock = @QuantidadeEmStock,
        EmUso = @EmUso,
        ImagemURL = @ImagemURL,
        IDAdministrador = @IDAdministrador
    WHERE ID = @ID;
END;
GO

-- Procedure para inserir uma Montagem
CREATE PROCEDURE spMontagem_Insert
    @IDIngrediente INT,
    @IDProduto INT,
    @Ordem INT,
    @Descricao NVARCHAR(90)
AS
BEGIN
    INSERT INTO Montagem (
        IDIngrediente, IDProduto, Ordem, Descricao
    )
    VALUES (
        @IDIngrediente, @IDProduto, @Ordem, @Descricao
    );
END;
GO

-- Procedure para inserir uma Linha de Montagem
CREATE PROCEDURE spLinhaDeMontagem_Insert
    @DataDeInicio DATETIME2(7),
    @DataDeFim DATETIME2(7),
    @Estado BIT,
    @IDFuncionario INT,
    @IDProduto INT
AS
BEGIN
    INSERT INTO LinhaDeMontagem (
        DataDeInicio, DataDeFim, Estado, IDFuncionario, IDProduto
    )
    VALUES (
        @DataDeInicio, @DataDeFim, @Estado, @IDFuncionario, @IDProduto
    );
END;
GO

-- Procedure para inserir uma Operação
CREATE PROCEDURE spOperacao_Insert
    @Quantidade INT,
    @ValorUnitario DECIMAL(4, 2),
    @ValorTotal DECIMAL(6, 2),
    @DataDaOperacao DATETIME2(7),
    @IDAdministrador INT
AS
BEGIN
    INSERT INTO Operacao (
        Quantidade, ValorUnitario, ValorTotal, DataDaOperacao, IDAdministrador
    )
    VALUES (
        @Quantidade, @ValorUnitario, @ValorTotal, @DataDaOperacao, @IDAdministrador
    );
END;
GO

-- Procedure para inserir uma Compra
CREATE PROCEDURE spCompra_Insert
    @IDIngrediente INT,
    @IDOperacao INT
AS
BEGIN
    INSERT INTO Compra (IDIngrediente, IDOperacao)
    VALUES (@IDIngrediente, @IDOperacao);
END;
GO

-- Procedure para inserir uma Venda
CREATE PROCEDURE spVenda_Insert
    @IDOperacao INT,
    @IDProduto INT
AS
BEGIN
    INSERT INTO Venda (IDOperacao, IDProduto)
    VALUES (@IDOperacao, @IDProduto);
END;
GO

-- Procedure para atualizar uma Operação
CREATE PROCEDURE spOperacao_Update
    @ID INT,
    @Quantidade INT,
    @ValorUnitario DECIMAL(4, 2),
    @ValorTotal DECIMAL(6, 2),
    @DataDaOperacao DATETIME2(7),
    @IDAdministrador INT
AS
BEGIN
    UPDATE Operacao
    SET
        Quantidade = @Quantidade,
        ValorUnitario = @ValorUnitario,
        ValorTotal = @ValorTotal,
        DataDaOperacao = @DataDaOperacao,
        IDAdministrador = @IDAdministrador
    WHERE ID = @ID;
END;
GO
